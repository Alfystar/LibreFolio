Ciao! Sto lavorando su un portfolio tracker finanziario self-hosted chiamato **LibreFolio**.

## Stack Tecnologico

- **Backend Python**: FastAPI + SQLModel + SQLite + Alembic + Pipenv
- **Frontend**: SvelteKit + Tailwind + Skeleton UI (in sviluppo)
- **Deploy**: Single Docker image (backend serve gli asset statici del frontend)

## Architettura

### Database (SQLite)
- **Users & Settings**: Multi-utenza con preferenze (valuta base, lingua, tema)
- **Brokers**: Contenitori flessibili con flag per overdraft/shorting
- **Assets**: Supporto per azioni, ETF, crypto, bond, prestiti P2P (scheduled-yield)
- **Transactions**: Tabella unificata per tutti i movimenti (BUY, SELL, DIVIDEND, INTEREST, DEPOSIT, WITHDRAWAL, FEE, TAX, TRANSFER, FX_CONVERSION, ADJUSTMENT)
- **FX Rates**: Multi-provider (ECB, FED, BOE, SNB) con fallback e backward-fill
- **Price History**: Prezzi da yfinance, JustETF, CSS scraper

### Servizi Implementati
- **TransactionService**: CRUD, validazione saldi giorno-per-giorno, linking bidirezionale
- **BrokerService**: CRUD con depositi iniziali, summary con holdings
- **FX Service**: Sync tassi multi-provider, conversioni con forward-fill
- **Asset Services**: Metadata, pricing, scheduled-yield valuation
- **Provider Registry**: AbstractProviderRegistry per auto-discovery di provider (FX, Asset, BRIM)

### Principi Chiave
- Tutti i **calcoli sono nel backend** (Python); il frontend solo visualizza
- **FIFO matching calcolato a runtime** (no split persistiti)
- **Valutazione scheduled-yield** calcolata dalla schedule interessi
- Le migrazioni DB sono gestite con **Alembic**
- Codice, commenti, docstrings, README e documentazione in **inglese**
- Solo l'UI frontend √® multilingue (EN, IT, FR, ES)

## Stato Attuale (Dicembre 2025)

### ‚úÖ Completato
- **Phase 1-4**: Database, Schemas, Services, API per Brokers e Transactions
- **Test Suite**: 7/7 categorie passano (External, DB, Schemas, Utils, Services, API, E2E)
- **FX Multi-Provider**: ECB, FED, BOE, SNB con fallback automatico
- **Asset Providers**: yfinance, JustETF, CSS Scraper, Scheduled Investment

### üî≤ Da Implementare
- **Phase 5 (BRIM)**: Broker Report Import Manager - import file broker con flusso parse‚Üíreview‚Üíimport (Generic CSV, Directa, Degiro, etc.)
- **Phase 6-7**: Runtime Analysis (FIFO, KPIs), Portfolio Aggregations
- **Phase 8**: Scheduler e Autenticazione
- **Phase 9**: Frontend SvelteKit
- **Phase 10**: Docker deploy

## Comandi Utili

```bash
# Visualizza aiuto per i comandi disponibili
./dev.sh --help
./dev.sh test --help

# Esegui tutti i test
./dev.sh test all

# Avvia server di sviluppo
./dev.sh run
```

## Note per lo Sviluppo

‚ö†Ô∏è **Progetto embrionale**: Il codice esiste solo su questa macchina. √à preferibile modificare senza mantenere backward compatibility o legacy code. L'obiettivo √® avere un codebase pulito e mantenibile quando il progetto sar√† pronto per la condivisione.

Prima di proseguire con il prossimo passo:
1. ‚úÖ Rivedi lo stato attuale del progetto (codebase, modelli, migrazioni, endpoints)
2. ‚úÖ Segnala eventuali inconsistenze o necessit√† di cleanup
3. ‚úÖ Poi ti invier√≤ il prossimo prompt per continuare lo sviluppo

Grazie!

